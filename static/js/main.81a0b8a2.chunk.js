(this["webpackJsonpdistr-front"]=this["webpackJsonpdistr-front"]||[]).push([[0],{267:function(t,e){},276:function(t,e){},294:function(t,e){},296:function(t,e){},313:function(t,e){},314:function(t,e){},379:function(t,e){},381:function(t,e){},390:function(t,e){},392:function(t,e){},417:function(t,e){},419:function(t,e){},420:function(t,e){},426:function(t,e){},439:function(t,e){},451:function(t,e){},454:function(t,e){},459:function(t,e){},470:function(t,e){},473:function(t,e){},539:function(t,e,n){"use strict";n.r(e);var r=n(19),c=n(7),i=n(8),s=n(14),a=n(13),o=n(0),u=n(84),d=n(560),f=n(561),b=n(564),l=n(242),h=n(557),p=n(562),j=n(563),m=n(559),v=n(87),w=n(141),g=n(25),x=n.n(g),O=n(88),k=n(233),y=n.n(k),B=n(234),_=BigInt(1e18),E=function(){function t(e,n){Object(c.a)(this,t),this.acc=BigInt(0),this.current=e,this.lastSeen=n}return Object(i.a)(t,[{key:"add",value:function(t,e,n){this._update(n,e),this.current+=t}},{key:"_add",value:function(t,e){this.lastSeen=e,this.current+=t}},{key:"_sub",value:function(t,e){this.lastSeen=e,this.current-=t}},{key:"sub",value:function(t,e,n){this._update(n,e),this.current-=t}},{key:"_update",value:function(t,e){if(e<this.lastSeen)throw new Error("downTime");var n=e-this.lastSeen;this.acc+=this.current*_/t*BigInt(n),this.lastSeen=e}},{key:"finalize",value:function(t,e){var n=t-this.lastSeen;return this.acc+this.current*_/e*BigInt(n)}}]),t}(),I=n(558),P=new B("wss://mainnet.infura.io/ws/v3/".concat("3c3dfdec6ce94abc935977aa995d1a8c")),S={distribution:new I.a([]),setBalances:function(t){S.distribution.next(t)}},z=P.utils.sha3("Transfer(address,address,uint256)"),C="0x49519631B404E06ca79C9C7b0dC91648D86F08db",N="0x"+"0".repeat(40),A=11731951,F=11717846,L=new Map,D=new E(BigInt(0),A);function J(){return T.apply(this,arguments)}function T(){return(T=Object(O.a)(x.a.mark((function t(){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P.eth.getPastLogs({fromBlock:F,toBlock:A,address:C,topics:[z]});case 2:t.sent.forEach((function(t){var e="0x".concat(t.topics[1].substr(26)),n="0x".concat(t.topics[2].substr(26)),r=BigInt(t.data);if(e===N){D._add(r,A);var c=L.get(n);c?c._add(r,A):L.set(n,new E(r,A))}else if(n===N){D._sub(r,A);var i=L.get(e);if(!i)throw new Error("from unknown");i._sub(r,A)}else{var s=L.get(e);if(!s)throw new Error("from unknown");s._sub(r,A);var a=L.get(n);a?a._add(r,A):L.set(n,new E(r,A))}}));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function H(t){return M.apply(this,arguments)}function M(){return(M=Object(O.a)(x.a.mark((function t(e){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P.eth.getPastLogs({fromBlock:A,toBlock:e,address:C,topics:[z]});case 2:t.sent.forEach((function(t){return V(t)})),R(e);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function R(t){var e=function(t){var e=BigInt(t-A)*_,n=D.current;return Array.from(L.entries()).map((function(r){var c=Object(v.a)(r,2),i=c[0],s=c[1];return{address:i,distributionPercent:Number(s.finalize(t,n)*BigInt(1e6)/e)/1e4}})).sort((function(t,e){var n=t.distributionPercent,r=e.distributionPercent;return n<r?1:n>r?-1:0}))}(t);S.setBalances(e.map((function(t,e){return Object(w.a)(Object(w.a)({},t),{},{id:e+1})}))),console.log("updated",t)}function V(t){var e="0x".concat(t.topics[1].substr(26)),n="0x".concat(t.topics[2].substr(26)),r=BigInt(t.data),c=t.blockNumber,i=D.current;if(e===N){!function(t,e){D._add(t,e)}(r,c);var s=L.get(n);s?s.add(r,c,i):L.set(n,new E(r,c)),q(i,c,[s])}else if(n===N){!function(t,e){D._sub(t,e)}(r,c);var a=L.get(e);if(!a)throw new Error("from unknown");a.sub(r,c,i),q(i,c,[a])}else{var o=L.get(e);if(!o)throw new Error("from unknown");o.sub(r,c,i);var u=L.get(n);u?u.add(r,c,i):L.set(n,new E(r,t.blockNumber))}}function q(t,e,n){Array.from(L.keys()).forEach((function(r){n.includes(r)||L.get(r)._update(t,e)}))}function G(){var t=!1;P.eth.subscribe("newBlockHeaders",(function(e,n){e||t||(t=!0,R(n.number),t=!1)})),P.eth.subscribe("logs",{address:C,topics:[z]},(function(e,n){e||(V(n),t||(t=!0,R(n.blockNumber),t=!1))}))}y.a.once(Object(O.a)(x.a.mark((function t(){var e;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.time("distr"),t.next=3,P.eth.getBlockNumber();case 3:return e=t.sent,t.next=6,J();case 6:return t.next=8,H(e);case 8:console.timeEnd("distr"),G();case 10:case"end":return t.stop()}}),t)}))))();var K=S;var Q=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=Object(o.useState)(e||t.getValue()),r=Object(v.a)(n,2),c=r[0],i=r[1];return Object(o.useEffect)((function(){var e=t.subscribe((function(t){i(t)}));return function(){return e.unsubscribe()}})),c},U=function(){var t=Q(K.distribution);return Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(f.a,{align:"center",children:Object(r.jsx)(h.a,{columns:[{property:"id",header:Object(r.jsx)(p.a,{children:"#"}),primary:!0},{property:"address",header:Object(r.jsx)(p.a,{children:"Address"}),render:function(t){return Object(r.jsx)(p.a,{style:{fontFamily:"monospace"},children:t.address})}},{property:"destribution",header:"Distribution",render:function(t){return Object(r.jsxs)(j.a,{anchor:"center",children:[Object(r.jsx)(f.a,{children:Object(r.jsx)(m.a,{values:[{value:t.distributionPercent}],thickness:"medium",size:"medium"})}),Object(r.jsxs)(f.a,{direction:"row",align:"center",pad:{bottom:"xsmall"},children:[Object(r.jsx)(p.a,{size:"xlarge",weight:"bold",children:t.distributionPercent}),Object(r.jsx)(p.a,{size:"small",children:"%"})]})]})}}],data:t})})})},W=function(t){Object(s.a)(n,t);var e=Object(a.a)(n);function n(){return Object(c.a)(this,n),e.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return Object(r.jsxs)(d.a,{theme:l.grommet,children:[Object(r.jsx)(f.a,{align:"center",pad:"large",children:Object(r.jsx)(b.a,{level:"3",children:"Realtime Component LP rewards distribution"})}),Object(r.jsx)(U,{})]})}}]),n}(o.Component);Object(u.render)(Object(r.jsx)(W,{}),document.getElementById("root"))}},[[539,1,2]]]);
//# sourceMappingURL=main.81a0b8a2.chunk.js.map